<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>【基于图模型的因果推断】4 图模型的分析 | Random-Walker in the Knowledge Category</title><meta name="author" content="Ruijie He"><meta name="copyright" content="Ruijie He"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="《因果推断：基于图模型的分析》学习笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="【基于图模型的因果推断】4 图模型的分析">
<meta property="og:url" content="https://hrjtju.github.io/2024/03/09/2024/03/2024-03-09-Casual_Inference-04/index.html">
<meta property="og:site_name" content="Random-Walker in the Knowledge Category">
<meta property="og:description" content="《因果推断：基于图模型的分析》学习笔记">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hrjtju.github.io/img/header/CasualInference.png">
<meta property="article:published_time" content="2024-03-08T16:00:00.000Z">
<meta property="article:modified_time" content="2024-03-10T06:52:06.064Z">
<meta property="article:author" content="Ruijie He">
<meta property="article:tag" content="Casual_Inference">
<meta property="article:tag" content="Probablistic_Graph_Models">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hrjtju.github.io/img/header/CasualInference.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hrjtju.github.io/2024/03/09/2024/03/2024-03-09-Casual_Inference-04/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?84a2e12fa5f41f1d7c86b0eb39ca1eab";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-M1C6DBL0RL"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-M1C6DBL0RL');
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '【基于图模型的因果推断】4 图模型的分析',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-03-10 14:52:06'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/arisu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><hr class="custom-hr"/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/header/CasualInference.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Random-Walker in the Knowledge Category"><img class="site-icon" src="/img/logo.jpg"/><span class="site-name">Random-Walker in the Knowledge Category</span></a></span><div id="menus"><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">【基于图模型的因果推断】4 图模型的分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-03-08T16:00:00.000Z" title="Created 2024-03-09 00:00:00">2024-03-09</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-03-10T06:52:06.064Z" title="Updated 2024-03-10 14:52:06">2024-03-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/posts/">posts</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">5.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>20min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="【基于图模型的因果推断】4 图模型的分析"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="1-基本图模型结构的分析"><a href="#1-基本图模型结构的分析" class="headerlink" title="1 基本图模型结构的分析"></a>1 基本图模型结构的分析</h1><h2 id="1-1-入室盗窃还是热带风暴"><a href="#1-1-入室盗窃还是热带风暴" class="headerlink" title="1.1 入室盗窃还是热带风暴"></a>1.1 入室盗窃还是热带风暴</h2><p>Holmes先生在办公室接到邻居打来的电话并告诉他：他家的防盗警报响了。由于担心家中被盗，Holmes先生立刻开车回家。在回家的路上，Holmes先生在广播中听说他家一带正在发生热带风暴。考虑到可能是风暴误触发了防盗警报，他又驾车返回公司。</p>
<p>那么核心问题是，到底是什么（以多大的概率）触发了防盗警报？根据提供的信息，我们可以画出这个问题对应的因果图。其中<script type="math/tex">B</script>表示Holmes先生家中是否被盗，<script type="math/tex">E</script>表示是否发生热带风暴，<script type="math/tex">A</script>表示警报是否响起，<script type="math/tex">R</script>表示电台是否告知发生热带风暴。这几个变量都是二值变量：<script type="math/tex">1</script>代表发生，<script type="math/tex">0</script>代表不发生</p>
<p><img src="/img/2024/Pasted%20image%2020240308094634-1709913361528-1.png" alt="Pasted image 20240308094634" style="zoom:33%;" /></p>
<center>图1：疑似盗窃事件中的因果图</center>

<p>不难注意，在图中采样路径的时候会遇到下面三种结构：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>结构名称</th>
<th>结构图示</th>
</tr>
</thead>
<tbody>
<tr>
<td>链</td>
<td>$A \rightarrow B \rightarrow C$</td>
</tr>
<tr>
<td>分叉</td>
<td>$A \leftarrow B \rightarrow C$</td>
</tr>
<tr>
<td>对撞</td>
<td>$A \rightarrow B \leftarrow C$</td>
</tr>
</tbody>
</table>
</div>
<p>事实上，这是组成任何图模型结构的基本结构。下面将着重讨论这三种基本结构。</p>
<h2 id="1-2-链"><a href="#1-2-链" class="headerlink" title="1.2 链"></a>1.2 链</h2><p>在图1中，我们取路径<script type="math/tex">B \rightarrow A \rightarrow W</script>进行分析，具体分为固定<script type="math/tex">A</script>和不固定<script type="math/tex">A</script>两种情况。</p>
<p><strong>不固定</strong><br>不固定<script type="math/tex">A</script>的情况下，它会受到<script type="math/tex">B</script>的影响：如果<script type="math/tex">B = 1</script>，那么<script type="math/tex">A</script>大概率会等于<script type="math/tex">1</script>。在这种情况下，邻居可以通过观察<script type="math/tex">A</script>来决定<script type="math/tex">W</script>。换句话说，<script type="math/tex">W</script>会受到<script type="math/tex">B</script>的影响。反过来说，如果<script type="math/tex">W=1</script>，则一定概率下可以推知<script type="math/tex">B=1</script>。总之，<font color="red">在链式结构中，没有给定中间变量取值的条件下，两端的节点变量会互相影响（如下图所示）</font>.</p>
<p><img src="/img/2024/Pasted%20image%2020240308121641-1709913396054-4.png" alt="Pasted image 20240308121641" style="zoom: 50%;" /></p>
<center>图2：不固定中间变量的链</center>

<p><strong>固定</strong><br>如果控制了中间的节点，事情就变得不同了。试想如果由某些外力使得<script type="math/tex">A=1</script>，<script type="math/tex">B\rightarrow W</script>以及<script type="math/tex">W \rightarrow B</script>这两条信息通道将会被阻断。如果报警机构出现故障，此时相当于<script type="math/tex">B</script>被固定为一个值，它就不能反映家中是否失窃，同时通过邻居的反映也无法得知此事。总之，<font color="red">在链式结构中，如果中间变量被固定为某个值，则两端节点之间的信息通道将会被截断（如下图所示）</font>.</p>
<p><img src="/img/2024/Pasted%20image%2020240308122247.png" alt="400" style="zoom:50%;" /></p>
<center>图3：固定了中间变量的链</center>

<p><strong>联合概率</strong><br>从数学的角度，也可以这样考虑。在图2和图3所示的因果图中，所有变量的联合分布有</p>
<script type="math/tex; mode=display">
P(b, a, w) = P(b)P(a|b)P(w|a).</script><p>将<script type="math/tex">P(b|a)</script>展开，整理得</p>
<script type="math/tex; mode=display">
P(w|b,a) = \frac{P(b, a, w)}{P(b, a)} = \frac{P(b)P(a|b)P(w|a)}{P(b)P(a|b)} = P(w|a),</script><p>于是得到<script type="math/tex">W \perp\!\!\!\perp B | A</script>，这也印证了上面做两种分类的意义。</p>
<blockquote>
<p>在考虑作为随机变量的变量时，我们为了简便使用大写<script type="math/tex">A</script>（上一篇中用的是正体，是为了和其他进行区分）。当考虑变量<script type="math/tex">A</script>取某个值的概率时，我们用小写。</p>
</blockquote>
<h2 id="1-3-分叉"><a href="#1-3-分叉" class="headerlink" title="1.3 分叉"></a>1.3 分叉</h2><p>下面以图1中的分叉结构<script type="math/tex">A \leftarrow E \rightarrow R</script>作为例子进行讨论。类似地，我们也做中间变量<script type="math/tex">E</script>固定与否的两种情形。</p>
<blockquote>
<p>为了防止读者忘记这些符号的含义，这里做一下Reminder：<script type="math/tex">A</script>是报警是否启动，<script type="math/tex">E</script>是热带风暴是否发生，<script type="math/tex">R</script>是电台是否广播发生热带风暴。</p>
</blockquote>
<p><strong>不固定</strong><br>有了上面的一个例子，我想我们现在已经轻车熟路了。在不固定中间节点的情况下，<script type="math/tex">E=1</script>的情形下很可能造成<script type="math/tex">A=1</script>且<script type="math/tex">R=1</script>。于是如果<strong>观测到</strong><script type="math/tex">A=1</script>，那么很可能我们也可以观测到<script type="math/tex">R=1</script>。总之，<font color="red">分叉结构中的中间变量不被固定时，两侧变量可以相互影响，如下图所示</font>。</p>
<p><img src="/img/2024/Pasted%20image%2020240308123243.png" alt="400" style="zoom:50%;" /></p>
<center>图4：未固定中间变量的分叉结构</center>

<p><strong>固定</strong><br>反过来，一旦<script type="math/tex">E</script>被固定，无论<script type="math/tex">A</script>的值如何变化，都不会影响到<script type="math/tex">R</script>。（<strong>因为在本例中，二者没有其他的共因</strong>）。十分类似地，<font color="red">路径两端变量之间的信息传递将再次被阻断</font>，如下图所示。</p>
<p><img src="/img/2024/Pasted%20image%2020240308123303.png" alt="400" style="zoom:50%;" /></p>
<center>图5：固定了中间变量的分叉结构</center>

<p><strong>联合概率</strong><br>我们再来考虑这个小系统中变量的联合概率：</p>
<script type="math/tex; mode=display">P(a, e, r) = P(e)P(a|e)P(r|e),</script><p>然后考虑条件概率</p>
<script type="math/tex; mode=display">
P(a|r, e) = \frac{P(a, e, r)}{P(e, r)} = \frac{P(e)P(a|e)P(r|e)}{P(r|e)P(e)} = P(a|e),</script><p>所以有<script type="math/tex">A \perp\!\!\!\perp R | E</script>。</p>
<h2 id="1-4-对撞"><a href="#1-4-对撞" class="headerlink" title="1.4 对撞"></a>1.4 对撞</h2><p>当我们考虑对撞的时候，事情就变得有趣起来了。我们选取图1中的<script type="math/tex">B \rightarrow A \leftarrow E</script>进行分析。其中<script type="math/tex">B</script>是家中是否失窃，<script type="math/tex">A</script>是报警是否响起，<script type="math/tex">E</script>是热带风暴是否发生。像前面一样，我们也讨论<script type="math/tex">A</script>是否被固定的情形。</p>
<p><strong>不固定</strong><br>在不固定<script type="math/tex">A</script>时，<script type="math/tex">B=1</script>或<script type="math/tex">E=1</script>都很有可能导致<script type="math/tex">A=1</script>。当观测到<script type="math/tex">A=1</script>时，没有充足理由证明<script type="math/tex">A=1</script>还是<script type="math/tex">E=1</script>抑或是二者兼而有之。进一步地，在中间变量<script type="math/tex">A</script>没有取值时，两侧的节点没有影响。<font color="red">也就是说，在不固定对撞结构的中间变量时，两侧变量之间的信息交流被阻断</font>（如下图所示）。</p>
<p><img src="/img/2024/Pasted%20image%2020240308125700.png" alt="400" style="zoom:50%;" /></p>
<center>图6：中间变量不固定时的对撞结构</center>

<p><strong>固定</strong><br>在固定了中间变量<script type="math/tex">E</script>时，神奇的事情发生了：如果<strong>固定</strong><script type="math/tex">E=1</script>时，如果<script type="math/tex">A</script>和<script type="math/tex">R</script>中有一个为<script type="math/tex">0</script>，则另一个一定为<script type="math/tex">1</script>；相应地，如果<strong>固定</strong><script type="math/tex">E=0</script>，则<script type="math/tex">B</script>和<script type="math/tex">E</script>大概率都为零。所以<font color="red">在固定对撞结构的中间变量时，两侧变量会相互影响，如下图所示。</font>这件事情有一个直观的解释：假设成为名人至少需要才华和美貌中的一样。如果一个名人是一个具有精湛演技的演员，你就可以做出“辩解”，他/她不需要比普通人更漂亮了。这里也涉及一个对撞结构，而确定中间变量之后造成的两端变量相互影响的现象也被称为<strong>辩解效应</strong>。</p>
<p><img src="/img/2024/Pasted%20image%2020240308131000.png" alt="400" style="zoom:50%;" /></p>
<center>图7：中间变量被固定时的对撞结构，辩解效应发生了</center>

<p><strong>联合概率</strong><br>最后我们通过概率透镜来看这样的现象。首先考虑联合概率</p>
<script type="math/tex; mode=display">
P(b, a, e) = P(b)P(e)P(a|b, e)</script><p>在不给定中间变量的取值时，有</p>
<script type="math/tex; mode=display">
P(b, e) = \sum_{a \in A} P(b, a, e)\,\mathrm{d}a = P(b)P(e)\sum\limits_{a \in A} P(a|b, e) = P(b)P(e).</script><p>这说明了当<script type="math/tex">A</script>没有给定时，两变量是独立的，即<script type="math/tex">B \perp\!\!\!\perp E | \varnothing</script>，其中<script type="math/tex">\varnothing</script>表示<script type="math/tex">A</script>的取值未知。<br>当给定了<script type="math/tex">A</script>的取值时，会得到一个丑陋的表达式：</p>
<script type="math/tex; mode=display">
\begin{align*}
P(b, e|a) &= \frac{P(b, a, e)}{P(a)}
\\&= \frac{P(b)P(e)P(a|b, e)}{P(a)} &\text{联合概率}
\\&= \frac{\frac{P(a)P(b|a)}{P(a|b)} \frac{P(a)P(e|a)}{P(a|e)} P(a|b, e)}{P(a)}  &\text{全概率公式}
\\&= P(b|a)P(e|a) \frac{P(a|b, e)P(a){\color{red}P(b, e)}}{P(a|b)P(a|e){\color{red}P(b)P(e)}}  &P(b, e) = P(b)P(e)
\\&= P(b|a)P(e|a) {\color{blue}\frac{P(a,b, e)P(a)}{P(a, b)P(a, e)}}
\end{align*}</script><p>蓝色的这一项不一定为<script type="math/tex">1</script>，所以<script type="math/tex">P(b, e|a) \ne P(b|a)P(e|a)</script>。</p>
<p>为了加深读者对对撞结构的印象，这里再提供一个自己的例子。</p>
<p><strong>示例：硬币和闹钟</strong><br>假设有一个闹钟，它是否闹铃取决于掷两枚硬币的结果。只有当两枚硬币不全是正面时，它才不会响。记两枚硬币的抛掷结果的随机变量分别为<script type="math/tex">X</script>和<script type="math/tex">Y</script>，闹钟是否闹铃为<script type="math/tex">E</script>，则可以绘制出下面的表格</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$X$</th>
<th style="text-align:center">$Y$</th>
<th style="text-align:center">$E$</th>
<th style="text-align:center">$P(X, Y, E)$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">正</td>
<td style="text-align:center">正</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0.25$</td>
</tr>
<tr>
<td style="text-align:center">正</td>
<td style="text-align:center">反</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0.25$</td>
</tr>
<tr>
<td style="text-align:center">反</td>
<td style="text-align:center">正</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0.25$</td>
</tr>
<tr>
<td style="text-align:center">反</td>
<td style="text-align:center">反</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$0.25$</td>
</tr>
</tbody>
</table>
</div>
<center>表1：硬币抛掷结果和闹钟是否闹铃的关系及联合概率</center>

<p>在不观测结果<script type="math/tex">E</script>之前，我们有<script type="math/tex">X \perp\!\!\!\perp Y | \varnothing</script>（边缘独立），但一旦观察到或固定<script type="math/tex">E</script>时，<script type="math/tex">X</script>和<script type="math/tex">Y</script>不再相互独立。</p>
<p>接下来我们对原问题做一些修改：我们通过一个报告员来得知闹钟是否响起，且在闹钟没有响起时，有<script type="math/tex">50\%</script>的概率误报。原来的表格进行修改后如下：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">$X$</th>
<th style="text-align:center">$Y$</th>
<th style="text-align:center">$E$</th>
<th style="text-align:center">$W$</th>
<th style="text-align:center">$P(X, Y, W)$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">正</td>
<td style="text-align:center">正</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0.25$</td>
</tr>
<tr>
<td style="text-align:center">正</td>
<td style="text-align:center">反</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0.25$</td>
</tr>
<tr>
<td style="text-align:center">反</td>
<td style="text-align:center">正</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0.25$</td>
</tr>
<tr>
<td style="text-align:center">反</td>
<td style="text-align:center">反</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$0.125$</td>
</tr>
<tr>
<td style="text-align:center">反</td>
<td style="text-align:center">反</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$0$</td>
<td style="text-align:center">$0.125$</td>
</tr>
</tbody>
</table>
</div>
<center>表2：修改后的硬币和闹钟问题：添加了有一定概率误报的报告员</center>

<p>此时如果无视结果<script type="math/tex">W</script>和闹钟结果<script type="math/tex">E</script>（这其实也是自然地，因为在修改后的问题设定里面我们无法直接得知闹钟的状态）我们也可以发现<script type="math/tex">X</script>和<script type="math/tex">Y</script>是独立的，而固定<script type="math/tex">W</script>后<script type="math/tex">X</script>和<script type="math/tex">Y</script>不再独立。如果把这个问题的因果图画出来，将会是下面这样：</p>
<p><img src="/img/2024/Pasted%20image%2020240308140044.png" alt="200" style="zoom:33%;" /></p>
<center>图8：修改后的硬币和闹钟问题的因果图</center>

<p>通过这个实例我们可以做出如下总结：</p>
<ul>
<li><strong>在未给定中间变量及其后代的取值时，对撞结构两侧变量互相独立</strong>；</li>
<li><strong>在固定中间变量或中间变量的后代的取值时，对撞结构两侧的变量相互依赖</strong>；</li>
<li><strong>没有因果关系的两个变量也可以有相关关系</strong>。</li>
</ul>
<p>我们在借用Monty大厅问题（Monty Hall problem，也称羊车门问题）作为本节的结束。</p>
<p><strong>示例：“羊车门”问题</strong><br>在某个电视节目中，有三扇关闭的门。其中一扇门后面有汽车，其他两扇门后面各有一只山羊。参赛者首先选择一扇门，然后主持人会将一扇后面有山羊的门打开，然后询问参赛者是否更换自己的选择。我们设参赛者开始选择的门为<script type="math/tex">X</script>，汽车的位置为<script type="math/tex">Y</script>，主持人打开的门为<script type="math/tex">Z</script>。我们可以这样考虑：假设参赛者选中了后面有车的门（概率为三分之一），则主持人可以打开剩下的门中的任何一扇；如果参赛者选中了后面有山羊的门（概率为三分之二），则主持人别无选择，因为剩下两扇门中一扇后面有汽车，根据规则主持人只能打开另一扇门。因此参赛者更换自己的选择获得轿车的概率更大。我们可以画出这个问题的因果图：</p>
<p><img src="/img/2024/Pasted%20image%2020240308142059.png" alt="200" style="zoom:33%;" /></p>
<center>图9：“羊车门”问题的因果图</center>

<p>通过因果透镜重新审视问题，则答案昭然若揭：主持人一旦做出选择，相当于固定了<script type="math/tex">Z</script>的值。对撞结构使得<script type="math/tex">X</script>和<script type="math/tex">Y</script>不再独立。</p>
<h1 id="2-d-划分"><a href="#2-d-划分" class="headerlink" title="2 d-划分"></a>2 d-划分</h1><p>实际的图模型往往会比较复杂，一对节点变量之间往往存在多条路径。在这种情形下，我们需要对图形中的节点变量的独立或依赖关系进行判定，也就是我们要讲解的d-划分。</p>
<h2 id="2-1-d-划分的概念"><a href="#2-1-d-划分的概念" class="headerlink" title="2.1 d-划分的概念"></a>2.1 d-划分的概念</h2><p><strong>d-划分（Directed Seperation，也称有向分割）</strong> 是一种在复杂图结构下依据节点变量之间的连接关系，分析节点变量之间相互独立或相互依赖关系的方法。简单而言，如果两个变量之间的<em>每一条</em>路径都被阻断，则这两个节点是d-划分；否则称两个节点是d-连接。上面涉及到三个重要的细节：</p>
<ol>
<li>如果两个节点是d-划分，则二者之间的<strong>所有路径</strong>都需要被阻断</li>
<li>对于某一条路径，<strong>当其上的一点被阻断时，这条路径便被阻断</strong></li>
<li>“阻断”是指<strong>统计依赖关系的阻断</strong>。如果两个节点之间的唯一路径被阻断，则这两个节点对应的变量相互独立</li>
</ol>
<p>对于一条连接两点的路径<script type="math/tex">\boldsymbol{l}</script>，如果满足下面的条件，则该路径被变量集合<script type="math/tex">\mathcal{Z}</script>在取得特定值时阻断：</p>
<ul>
<li>路径中存在对撞结构，对撞节点（中间点）及其后代节点也不在<script type="math/tex">\mathcal{Z}</script>中</li>
<li>路径中存在链或分叉结构，且有至少一个节点在<script type="math/tex">\mathcal{Z}</script>中</li>
</ul>
<blockquote>
<p>回忆上一节有关三个基本结构何时阻断的内容，不难推出。</p>
</blockquote>
<p>现在给出d-划分的正式定义：</p>
<p><strong>定义：d-划分</strong><br>一条路径<script type="math/tex">\boldsymbol{p}</script>被节点集合<script type="math/tex">\mathcal{Z}</script>阻断，也就是在集合<script type="math/tex">\mathcal{Z}</script>中的元素都有取值时阻断，需要满足下面条件中至少一条</p>
<ul>
<li><script type="math/tex">\boldsymbol{p}</script>中包含链式结构<script type="math/tex">A \rightarrow B \rightarrow C</script>或分叉结构<script type="math/tex">A \leftarrow B \rightarrow C</script>时，<script type="math/tex">B \in \mathcal{Z}</script>，</li>
<li><script type="math/tex">\boldsymbol{p}</script>中包含<script type="math/tex">A \rightarrow B\leftarrow A</script>，<script type="math/tex">\Big(B \cup \text{Descendents}\big(\{ B \}\big)\Big) \cap \mathcal{Z} = \varnothing</script>。<br>进一步地，如果节点<script type="math/tex">X</script>和<script type="math/tex">Y</script>之间的所有路径均被阻断，则<script type="math/tex">X</script>和<script type="math/tex">Y</script>被集合<script type="math/tex">\mathcal{Z}</script>所d-划分，即<script type="math/tex">X \perp\!\!\!\perp Y | \mathcal{Z}</script>，这称为<strong>条件d-划分</strong>。如果<script type="math/tex">\mathcal{Z} = \varnothing</script>，则这样的d-划分称为<strong>无条件d-划分</strong>。</li>
</ul>
<p>使用d-划分可以让我们在不直接触碰严格的函数关系的情况下快速判断两个节点之间是否统计独立。这是使用图模型表达因果关系的优势。</p>
<p><strong>示例</strong><br>分析下面图模型中节点<script type="math/tex">Z</script>和<script type="math/tex">Y</script>之间的统计关系。</p>
<p><img src="/img/2024/Pasted%20image%2020240308155934.png" alt="600" style="zoom: 33%;" /></p>
<center>图10：示例中的图模型：使用d-划分分析变量之间的统计关系</center>

<ul>
<li>以节点<script type="math/tex">W</script>为条件<ul>
<li>对撞结构<script type="math/tex">Z \rightarrow W \leftarrow X</script>将被联通，节点<script type="math/tex">Z</script>和<script type="math/tex">Y</script>形成d-连接</li>
</ul>
</li>
<li>以节点<script type="math/tex">\{ W, X \}</script>为条件<ul>
<li>虽然对撞结构被打开，但随即<script type="math/tex">W \leftarrow X \rightarrow Y</script>因为固定了中间结点而被阻断。所以节点<script type="math/tex">Z</script>和<script type="math/tex">Y</script>形成d-划分</li>
</ul>
</li>
</ul>
<p>现在我们将图变得复杂一些：</p>
<p><img src="/img/2024/Pasted%20image%2020240308161217.png" alt="600" style="zoom:33%;" /></p>
<center>图11：修改后的图模型</center>

<p>根据观察，我们可以得出下面的结论：</p>
<ul>
<li>增加了一条路径<script type="math/tex">Z \leftarrow T \rightarrow Y</script>，如果不固定<script type="math/tex">T</script>，则节点<script type="math/tex">Z</script>和<script type="math/tex">Y</script>形成d-连接：<script type="math/tex">Z \perp\!\!\!\perp Y | T</script></li>
<li>如果取集合为<script type="math/tex">\{ T, W \}</script>，则节点<script type="math/tex">Z</script>和<script type="math/tex">Y</script>形成d-连接，因为虽然阻断了<script type="math/tex">Z \leftarrow {\color{red} T}\rightarrow Y</script>，但打开了<script type="math/tex">Z \rightarrow {\color{blue}W} \leftarrow X \rightarrow Y</script></li>
<li>以此类推</li>
</ul>
<p>可以验证下面的图中蓝色的集合使得二者变为d-连接，红色的集合使得二者变为d-划分：</p>
<p><img src="/img/2024/Pasted%20image%2020240308163551.png" alt="600" style="zoom:33%;" /></p>
<center>图12：划分集合性质的分布，其中箭头表示集合的包含关系</center>

<p>现在从Markov性的角度看。对于节点<script type="math/tex">Z</script>，如果所有外生变量<script type="math/tex">\{ U_{Z}, U_{T}, U_{X}, U_{Y}, U_{W}, U_{U} \}</script>相互独立，则给定其父母节点<script type="math/tex">T</script>的条件下，节点<script type="math/tex">Z</script>与所有非后代节点都独立，即<script type="math/tex">Z</script>与<script type="math/tex">X</script>和<script type="math/tex">Y</script>都独立。这是因为在给定<script type="math/tex">T</script>的条件下，路径<script type="math/tex">X \leftarrow T \rightarrow Y</script>被截断，而<script type="math/tex">Z \rightarrow W \leftarrow X \rightarrow Y</script>中天然存在的对撞节点阻断了这条通路。</p>
<blockquote>
<p>我们可以将上述推导过程推广值一般的有向无环图模型中。如果所有的外生变量相互独立，对于节点变量<script type="math/tex">Z</script>，给定其父母变量<script type="math/tex">T</script>的条件下，节点<script type="math/tex">Z</script>和所有其非后代节点之间相互独立。进一步，假设<script type="math/tex">W</script>是<script type="math/tex">Z</script>的一个子女节点，<script type="math/tex">X</script>是<script type="math/tex">Z</script>的一个非后代节点，可见节点<script type="math/tex">Z</script>和<script type="math/tex">X</script>之间不可能通过各自的外生变量建立d-连接。所以分析二者之间的关系秩序分析经过内生变量的路径。这些路径分为通过其父母节点<script type="math/tex">T</script>的路径（<strong>后门路径</strong>），和通过其子女节点<script type="math/tex">W</script>的路径（<strong>前门路径</strong>）</p>
<ul>
<li><p>考虑后门路径<script type="math/tex">A-T\rightarrow Z</script>，由于箭头从<script type="math/tex">T\rightarrow Z</script>，所以控制<script type="math/tex">T</script>可以阻断这条路径</p>
</li>
<li><p>由于<script type="math/tex">X</script>不是<script type="math/tex">Z</script>的后代节点，则从<script type="math/tex">Z</script>到<script type="math/tex">X</script>的路径中一定有一处箭头反向（从<script type="math/tex">X</script>方向指向<script type="math/tex">Z</script>）不妨假设它是<script type="math/tex">V_{i} \rightarrow V_{j}</script>（如下图），则一定存在一处对撞结构，这样的路径也被阻断。</p>
<p><img src="/img/2024/Pasted%20image%2020240308165726.png" a="600" style="zoom:33%;" /></p>
<center>图13：关于统计独立性的更一般讨论</center>

</li>
</ul>
<p>因此对于有向无环图<script type="math/tex">\mathscr{G}</script>，节点变量<script type="math/tex">Z</script>和非后代变量<script type="math/tex">X</script>之间在所有外生变量之间相互独立，且给定节点变量的父节点<script type="math/tex">\text{Parents}(\{ Z \})</script>的条件下，无论从前门还是后门都无法建立d-连接。因此<strong>在此条件下与所有非后代节点之间相互独立</strong>。</p>
</blockquote>
<h2 id="2-2-d-划分的判断"><a href="#2-2-d-划分的判断" class="headerlink" title="2.2 d-划分的判断"></a>2.2 d-划分的判断</h2><p>如果按照上面提出的判断方法，我们需要判断两个节点之间的所有路径是否被阻断，这显然十分麻烦。我们一般将图转换为无向图，然后在无向图中判断节点或节点集。在介绍具体方法之前，先引入一些定义。</p>
<p><strong>定义：祖先图（Ancestral Graph）</strong><br>祖先图地原图的一个子图，进包括判断条件独立性概率表达式中提到的变量及其祖先</p>
<p><strong>定义：道德图（Moral Graph）</strong><br>图<script type="math/tex">\mathscr{G} = (\mathcal{V}, \mathcal{E})</script>是一个有向无环图，对于图中任意节点<script type="math/tex">X</script>，若二元组<script type="math/tex">(X_{i}, X_{j}) \in \text{Parent}(\{ X \})</script>，则在图<script type="math/tex">\mathscr{G}</script>中添加一条无向边，并将图中素有无相边改为有向边，得到图<script type="math/tex">\mathscr{G}</script>的道德图</p>
<p><strong>定义：无向划分</strong><br>给定图<script type="math/tex">W</script>，<script type="math/tex">\mathcal{X}</script>，<script type="math/tex">\mathcal{Y}</script>和<script type="math/tex">\mathcal{Z}</script>是图中三个互不相交的节点集，<script type="math/tex">X_{i}, Y_{i}, Z_{i}</script>分别是<script type="math/tex">\mathcal{X}, \mathcal{Y}, \mathcal{Z}</script>中的节点。如果连接<script type="math/tex">X_{i}</script>和<script type="math/tex">Y_{i}</script>的任何一条路径中都含有<script type="math/tex">\mathcal{Z}</script>中的节点，则称<script type="math/tex">\mathcal{Z}</script>在无向图中分隔了<script type="math/tex">\mathcal{X}</script>和<script type="math/tex">\mathcal{Y}</script>，简称为“<script type="math/tex">\mathcal{X}</script>和<script type="math/tex">\mathcal{Y}</script>被<script type="math/tex">\mathcal{Z}</script>无向划分”。</p>
<p>下面不加证明地引入一个和无向划分和d-划分有关的定理：<br><strong>定理（Lauritzen）</strong><br>设<script type="math/tex">\mathscr{G} = (\mathcal{V}, \mathcal{E})</script>是一个有向无环图，<script type="math/tex">\mathcal{X}</script>，<script type="math/tex">\mathcal{Y}</script>和<script type="math/tex">\mathcal{Z}</script>是图中三个互不相交的节点集。<script type="math/tex">G_{a}</script>是包含<script type="math/tex">\mathscr{G}</script>中<script type="math/tex">\mathcal{X}, \mathcal{Y}, \mathcal{Z}</script>三个节点集及其各自祖先节点的<em>祖先图</em>，<script type="math/tex">G_{m}</script>是<script type="math/tex">G_{a}</script>的道德图，则<script type="math/tex">\mathcal{X}</script>和<script type="math/tex">\mathcal{Y}</script>在<script type="math/tex">\mathscr{G}</script>中为<script type="math/tex">\mathcal{Z}</script>所d-划分当且仅当<script type="math/tex">\mathcal{X}</script>和<script type="math/tex">\mathcal{Y}</script>在<script type="math/tex">G_{m}</script>中被<script type="math/tex">\mathcal{Z}</script>无向划分。</p>
<hr>
<p>根据上面的定理，我们可以构建出一个判断d-划分的流程：</p>
<ol>
<li><strong>画祖先图</strong> — 根据条件独立性概率表达式涉及的节点构建祖先图</li>
<li><strong>画道德图</strong> — 将祖先图中<em>拥有相同的子女节点</em>的节点之间使用无向边相连（若一个节点有多个父母节点，则将其两两相连）最后将整个图无向化</li>
<li><strong>删除条件</strong> — 对于解决的问题，删除其中涉及的条件变量（在给定xxx条件下的“xxx”）得到<em>结果图</em></li>
<li><strong>判别</strong> — 应用 Lauritzen 定理判断目标节点是否有边直接相连，如果没有直接相连的边，则说明目标变量给定条件下相互独立。</li>
</ol>
<p><strong>示例</strong><br>考虑下面的图模型，判断下面的问题</p>
<p><img src="/img/2024/Pasted%20image%2020240308221939.png" alt="200" style="zoom:33%;" /></p>
<center>图14：Lauritzen定理的应用示例模型</center>

<ol>
<li>请问<script type="math/tex">A</script>和<script type="math/tex">B</script>是否在给定<script type="math/tex">D</script>和<script type="math/tex">F</script>的条件下相互独立？</li>
</ol>
<script type="math/tex; mode=display">
P(A|B, D, F) \mathop{=}\limits^{?} P(A|D, F)</script><p><img src="/img/2024/Pasted%20image%2020240308223052.png" alt="900" style="zoom:50%;" /></p>
<center>图15：Lauritzen定理的应用-问题1，从左到右分别为（祖先图、连线图、道德图、结果图）</center>

<p>由图可知，<script type="math/tex">A</script>和<script type="math/tex">B</script>在给定条件下相互不独立。</p>
<ol>
<li>请问<script type="math/tex">D</script>和<script type="math/tex">E</script>是否边缘独立？</li>
</ol>
<p><img src="/img/2024/Pasted%20image%2020240308223905.png" alt="900" style="zoom:50%;" /></p>
<center>图16：Lauritzen定理的应用-问题2</center>

<p>由图可知，<script type="math/tex">D</script>和<script type="math/tex">E</script>边缘不独立。</p>
<ol>
<li><script type="math/tex">P(D|C, E, G) \mathop{=}\limits^{?} P(D|C)</script>,<br>本问题相当于：在给定<script type="math/tex">C</script>时，<script type="math/tex">D</script>是否既和<script type="math/tex">E</script>独立，也和<script type="math/tex">\mathscr{G}</script>独立？</li>
</ol>
<p><img src="/img/2024/Pasted%20image%2020240308224145.png" alt="900" style="zoom:50%;" /></p>
<center>图17：Lauritzen定理的应用-问题3</center>

<p>由图可知，<script type="math/tex">D</script>与<script type="math/tex">\mathscr{G}</script>相连，于是两个要求中有一个无法满足。因此<script type="math/tex">P(D|C, E, G) \ne P(D, C)</script>。</p>
<h2 id="2-3-d-划分变量集合搜索"><a href="#2-3-d-划分变量集合搜索" class="headerlink" title="2.3 d-划分变量集合搜索"></a>2.3 d-划分变量集合搜索</h2><p>在上一节中，我们主要解决的问题是形如“给定xxx条件，问xxx和xxx是否相互独立”这样的问题。本节我们探讨形如下面的问题：给定有向无环图<script type="math/tex">\mathscr{G} = (\mathcal{V}, \mathcal{E})</script>，已知其中的两个不交集合<script type="math/tex">\mathcal{A}</script>和<script type="math/tex">\mathcal{B}</script>，找一个节点集合<script type="math/tex">\mathcal{D}</script>，使得<script type="math/tex">\mathcal{B}</script>和<script type="math/tex">\mathcal{D}</script>被<script type="math/tex">\mathcal{A}</script>所d-划分，即<script type="math/tex">\mathcal{B} \perp\!\!\!\perp \mathcal{D} | \mathcal{A}</script></p>
<p>首先引入有效链的概念：</p>
<p><strong>定义：有效链（Active Chain）</strong><br>对于图模型<script type="math/tex">\mathscr{G}</script>中任意路径上任意无向连续相连的三个节点<script type="math/tex">X - Z - Y</script>，如果<script type="math/tex">X \ne Y</script>，且满足下面两个条件之一，则称这三个节点针对节点变量集合<script type="math/tex">\mathcal{A}</script>构成一个有效链（说的其实是信息可以通过这个结构）：</p>
<ol>
<li><p>满足<script type="math/tex">X-Z-Y</script>不是对撞结构，且<script type="math/tex">Z\notin\mathcal{A}</script></p>
</li>
<li><p>满足<script type="math/tex">X - Z - Y</script>是对撞结构，且<script type="math/tex">\Big( \{ Z \} \cup \text{Descendents}(\{ Z \}) \Big) \cap \mathcal{A} \ne \varnothing</script></p>
</li>
</ol>
<p>在给定节点变量集合<script type="math/tex">\mathcal{A}</script>的情况下，有效链两端的节点变量相互联通，请看下面的例子：</p>
<p><img src="/img/2024/Pasted%20image%2020240308225906.png" alt="300" style="zoom: 50%;" /></p>
<center>图18：有效链的一个例子</center>

<p>在图18中，假设节点集合为<script type="math/tex">\{ W \}</script>，则<script type="math/tex">X-T-Z</script>、<script type="math/tex">Y-T-Z</script>、<script type="math/tex">T-X-W</script>、<script type="math/tex">T-Z-W</script>和<script type="math/tex">X-W-Z</script>为有效链，而<script type="math/tex">X-T-Y</script>不是有效链。</p>
<p>我们回到本节开始时提出的那个问题：如何在给定有向无环图中不交节点集<script type="math/tex">\mathcal{A}</script>和<script type="math/tex">\mathcal{B}</script>的条件下，找到一个节点集<script type="math/tex">\mathcal{D}</script>使得它和<script type="math/tex">\mathcal{B}</script>被<script type="math/tex">\mathcal{A}</script>所d-划分。针对<script type="math/tex">\mathcal{B}</script>中的每个节点，找到在给定<script type="math/tex">\mathcal{A}</script>下与其d-连接的所有节点集合<script type="math/tex">\mathcal{R}</script>，则<script type="math/tex">\mathcal{D} = V - (\mathcal{A} \cup \mathcal{R})</script>。这样一来，原问题被简化为下面的形式：对<script type="math/tex">\mathcal{B}</script>中的一个节点<script type="math/tex">X</script>，如何找到给定<script type="math/tex">\mathcal{A}</script>情况下与其d-连接的所有节点变量的集合。为了做到这一点，可以找<script type="math/tex">\mathcal{B}</script>中所有和<script type="math/tex">X</script>相连的边，如<script type="math/tex">X-Z</script>，并将该边标记为<script type="math/tex">1</script>，再根据<script type="math/tex">Z</script>找到<script type="math/tex">Y</script>，判定给定<script type="math/tex">\mathcal{A}</script>的条件下<script type="math/tex">X - Z - Y</script>是否构成有效链。如果构成有效链，则将边<script type="math/tex">Z-Y</script>标记为<script type="math/tex">2</script>，并将<script type="math/tex">Z</script>和<script type="math/tex">Y</script>放入集合<script type="math/tex">\mathcal{R}</script>中，同时将<script type="math/tex">Z</script>替换为<script type="math/tex">X</script>，<script type="math/tex">Y</script>替换为<script type="math/tex">Z</script>，递归地进行上面的步骤，直到找不到有效链为止。最终得到<script type="math/tex">\mathcal{R}</script>。</p>
<p>在算法的实际实现中，我们从<script type="math/tex">\mathcal{B}</script>开始，逐步向外扩展我们找到的有效链。而算法中往往在<script type="math/tex">\mathscr{G}</script>上叠加反向箭头得到<script type="math/tex">G'</script>。这样做是有道理的：在图18中，假设<script type="math/tex">\mathcal{B} = \{ X \}</script>，<script type="math/tex">\mathcal{A} = \{ W \}</script>，现在寻找合适的<script type="math/tex">\mathcal{D}</script>。链<script type="math/tex">X \rightarrow T \rightarrow Z</script>中的<script type="math/tex">T \rightarrow Z</script>被和<script type="math/tex">X \leftarrow W \rightarrow Z</script>中的边<script type="math/tex">W \leftarrow Z</script>标注为<script type="math/tex">2</script>，从而漏掉了<script type="math/tex">X \rightarrow W \leftarrow Z \leftarrow T \leftarrow Y</script>。如果添加反向边，则可以<strong>引导</strong>算法找到这条被漏掉的路径，如下图所示（我们没有修改原图的结构）。</p>
<p><img src="/img/2024/Pasted%20image%2020240308235343.png" alt="400" style="zoom: 50%;" /></p>
<center>图19：使用双向箭头引导算法</center>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://hrjtju.github.io">Ruijie He</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://hrjtju.github.io/2024/03/09/2024/03/2024-03-09-Casual_Inference-04/">https://hrjtju.github.io/2024/03/09/2024/03/2024-03-09-Casual_Inference-04/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Casual-Inference/">Casual_Inference</a><a class="post-meta__tags" href="/tags/Probablistic-Graph-Models/">Probablistic_Graph_Models</a></div><div class="post_share"><div class="social-share" data-image="/img/header/CasualInference.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/03/08/2024/03/2024-03-08-Casual_Inference-03/" title="【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践"><img class="cover" src="/img/header/CasualInference.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/03/05/2024/03/2024-03-05-Casual_Inference-01/" title="【基于图模型的因果推断】1 绪论"><img class="cover" src="/img/header/CasualInference.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-05</div><div class="title">【基于图模型的因果推断】1 绪论</div></div></a></div><div><a href="/2024/03/05/2024/03/2024-03-05-Casual_Inference-02/" title="【基于图模型的因果推断】2 数学基础"><img class="cover" src="/img/header/CasualInference.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-05</div><div class="title">【基于图模型的因果推断】2 数学基础</div></div></a></div><div><a href="/2024/03/08/2024/03/2024-03-08-Casual_Inference-03/" title="【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践"><img class="cover" src="/img/header/CasualInference.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-08</div><div class="title">【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/arisu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Ruijie He</div><div class="author-info__description">Undergraduate in Tongji University</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">72</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/hrjtju"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">7月17日给博客换了一个主题，现在仍在装修中</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E5%9B%BE%E6%A8%A1%E5%9E%8B%E7%BB%93%E6%9E%84%E7%9A%84%E5%88%86%E6%9E%90"><span class="toc-text">1 基本图模型结构的分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%85%A5%E5%AE%A4%E7%9B%97%E7%AA%83%E8%BF%98%E6%98%AF%E7%83%AD%E5%B8%A6%E9%A3%8E%E6%9A%B4"><span class="toc-text">1.1 入室盗窃还是热带风暴</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E9%93%BE"><span class="toc-text">1.2 链</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E5%88%86%E5%8F%89"><span class="toc-text">1.3 分叉</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E5%AF%B9%E6%92%9E"><span class="toc-text">1.4 对撞</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-d-%E5%88%92%E5%88%86"><span class="toc-text">2 d-划分</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-d-%E5%88%92%E5%88%86%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="toc-text">2.1 d-划分的概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-d-%E5%88%92%E5%88%86%E7%9A%84%E5%88%A4%E6%96%AD"><span class="toc-text">2.2 d-划分的判断</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-d-%E5%88%92%E5%88%86%E5%8F%98%E9%87%8F%E9%9B%86%E5%90%88%E6%90%9C%E7%B4%A2"><span class="toc-text">2.3 d-划分变量集合搜索</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/09/2024/03/2024-03-09-Casual_Inference-04/" title="【基于图模型的因果推断】4 图模型的分析"><img src="/img/header/CasualInference.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【基于图模型的因果推断】4 图模型的分析"/></a><div class="content"><a class="title" href="/2024/03/09/2024/03/2024-03-09-Casual_Inference-04/" title="【基于图模型的因果推断】4 图模型的分析">【基于图模型的因果推断】4 图模型的分析</a><time datetime="2024-03-08T16:00:00.000Z" title="Created 2024-03-09 00:00:00">2024-03-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/08/2024/03/2024-03-08-Casual_Inference-03/" title="【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践"><img src="/img/header/CasualInference.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践"/></a><div class="content"><a class="title" href="/2024/03/08/2024/03/2024-03-08-Casual_Inference-03/" title="【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践">【基于图模型的因果推断】3 图模型和结构因果模型：理论和简单实践</a><time datetime="2024-03-07T16:00:00.000Z" title="Created 2024-03-08 00:00:00">2024-03-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/05/2024/03/2024-03-05-Casual_Inference-01/" title="【基于图模型的因果推断】1 绪论"><img src="/img/header/CasualInference.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【基于图模型的因果推断】1 绪论"/></a><div class="content"><a class="title" href="/2024/03/05/2024/03/2024-03-05-Casual_Inference-01/" title="【基于图模型的因果推断】1 绪论">【基于图模型的因果推断】1 绪论</a><time datetime="2024-03-04T16:00:00.000Z" title="Created 2024-03-05 00:00:00">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/05/2024/03/2024-03-05-Casual_Inference-02/" title="【基于图模型的因果推断】2 数学基础"><img src="/img/header/CasualInference.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【基于图模型的因果推断】2 数学基础"/></a><div class="content"><a class="title" href="/2024/03/05/2024/03/2024-03-05-Casual_Inference-02/" title="【基于图模型的因果推断】2 数学基础">【基于图模型的因果推断】2 数学基础</a><time datetime="2024-03-04T16:00:00.000Z" title="Created 2024-03-05 00:00:00">2024-03-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/01/2024/03/2024-03-01-TypeThTypeScript-02/" title="【类型论前导与TypeScript】2 TypeScript的控制语句"><img src="/img/header/TypeThIntro.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="【类型论前导与TypeScript】2 TypeScript的控制语句"/></a><div class="content"><a class="title" href="/2024/03/01/2024/03/2024-03-01-TypeThTypeScript-02/" title="【类型论前导与TypeScript】2 TypeScript的控制语句">【类型论前导与TypeScript】2 TypeScript的控制语句</a><time datetime="2024-02-29T16:00:00.000Z" title="Created 2024-03-01 00:00:00">2024-03-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By Ruijie He</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="200" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>